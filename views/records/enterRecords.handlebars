<link rel="stylesheet" type="text/css" href="/css/addRecords.css">
<div class="card card-body">
    <div>
        {{!-- <div class="card-body">
            <h1 class="font-weight-bold text-dark">Retrieve Patient's Particulars</h1>
        </div>

        <div class="card card-body">
            <div class="input-group">
                <input type="text" name="patientId" class="form-control"
                    placeholder="Enter patient ID to retrieve the particulars of that patient *" required />
                <span class="input-group-btn">
                    <a class="btn btn-info" href="/records/retrievePatient" role="button">Find <i class="fa fa-search"></i></a>
                </span>
            </div>
        </div> --}}

        <div class="card-body">
            <h1 class="font-weight-bold text-dark">Add Medical Records</h1>
        </div>


        <div class="card card-body">
            {{!-- Search button to find Patient --}}
            <div class="row">
                <div id="wrapper" class="col-sm-12 col-md-12 col-lg-12">
                    <div class="categoryForm">
                        <label class="font-italic text-dark">Patient name:</label>
                        <input id="query" type="text" class="form-control name" autocomplete="off"
                            placeholder="Search for patient Name *" />
                        <button id="searchButton" onclick="search()" class="btn btn-info"><i class="fa fa-search"></i></button>
                    </div>
                </div>
            </div>
            {{!-- ============================= --}}

            <br>

            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <fieldset class="col-sm-12 col-md-12 col-lg-12">
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <legend class="font-weight-bold"><i class="fas fa-user"></i> Patient's Particulars
                                </legend>
                            </div>
                        </div>

                        {{#if users}}
                        <div class="row">
                            {{#each users}}
                            <div class="col-sm-12 col-md-12 col-lg-12 patientcards">
                                <div class="card card-body border border-primary">
                                    <div class="row">
                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <p class="card-text">Patient's name:
                                                <span
                                                    class="font-weight-bold text-primary names" data-pname="{{name}}">{{name}}</span>
                                            </p>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <p class="card-text">Patient's ID:
                                                <span class="font-weight-bold text-primary">{{patientID}}</span>
                                            </p>
                                        </div>

                                        <div class="col-sm-12 col-md-4 col-lg-4">
                                            <p class="card-text">Gender:
                                                <span class="font-weight-bold text-primary">{{gender}}</span>
                                            </p>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <p class="card-text">Mobile phone no:
                                                <span class="font-weight-bold text-primary">{{mobileNo}}</span>
                                            </p>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <p class="card-text">Drug allergy:
                                                <span class="font-weight-bold text-primary">{{replaceCommas drugallergy}}</span>
                                            </p>
                                        </div>

                                        <div class="col-sm-12 col-md-6 col-lg-4">
                                            <p class="card-text">Major illness:
                                                <span class="font-weight-bold text-primary">{{replaceCommas majorillness}}</span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        {{/if}}

                        <div style="margin-top:20px; margin-bottom:15px;">
                            <div class="row">
                                <div class="btn-group col-sm-5 col-md-5 col-lg-5">
                                    <button class="btn btn-sm btn-success" id="consultationBtn"><i
                                            class="fa fa-list"></i> Consultation Records</button>
                                    <a href="/records/consultHistory" class="btn btn-sm btn-secondary" role="button">
                                        <i class="fa fa-history"></i> Consultation History
                                    </a>
                                </div>

                                <div id="consultModal" class="modal">
                                    <div class="modal-content">
                                        <span class="close">&times;</span>
                                        <div class="card-body">
                                            <h1 class="font-weight-bold text-dark">All Consultation Records</h1>
                                        </div>

                                        {{#if consults}}
                                        <div class="row">
                                            <div id="wrapper" class="col-sm-12 col-md-12 col-lg-12">
                                                <div class="categoryForm">
                                                    <label class="text-dark font-italic">Patient name:</label>
                                                    <input id="patientname" type="text" class="form-control" autocomplete="off"
                                                        placeholder="Enter patient name *" required />
                                                    <button class="btn btn-info" id="searchbtn" onclick="findConsultation()"><i
                                                            class="fa fa-search"></i></button>
                                                </div>
                                            </div>
                                        </div>

                                        <br>

                                        {{#each consults}}
                                        <div class="card card-body border border-info consultationcards">
                                            <div class="row">
                                                <div class="col-sm-12 col-md-6 col-lg-4">
                                                    <label class="font-italic text-dark">Patient Name:</label>
                                                    <p class="text-info font-weight-bold patientname" data-patientname="{{patientName}}">{{patientName}}</p>
                                                </div>

                                                <div class="col-sm-12 col-md-6 col-lg-4">
                                                    <label class="font-italic text-dark">Patient ID no:</label>
                                                    <p class="text-info font-weight-bold">{{patientID}}</p>
                                                </div>

                                                <div class="col-sm-12 col-md-6 col-lg-4">
                                                    <label class="font-italic text-dark">Date of Consultation:</label>
                                                    <p class="text-info font-weight-bold">
                                                        {{formatDate consultationDate 'DD MMM YYYY'}}</p>
                                                </div>
                                            </div>

                                            <br>

                                            <div class="row">
                                                <div class="col-sm-12 col-md-12 col-lg-12">
                                                    <label class="font-italic text-dark">Consultation
                                                        Reasons/Details:</label>
                                                    <p class="text-info font-weight-bold">{{replaceCommas consultation}}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        {{/each}}

                                        {{else}}
                                        <div class="card card-body border border-info">
                                            <div class="row">
                                                <div class="col-sm-12 col-md-12 col-lg-12">
                                                    <h3 class="font-weight-bold text-danger">No Consultation Records
                                                        have been recorded</h3>
                                                </div>
                                            </div>
                                        </div>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>

        <br>
        <br>

        <div class="card card-body">
            <div class="row">
                <form action="" method="post" id="enterRecords">
                    <fieldset>
                        <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12">
                                <legend class="font-weight-bold"><i class="fa fa-pencil-square-o"></i> Patient's Medical
                                    Records</legend>
                            </div>
                        </div>

                        <div class="card card-body border-primary">
                            {{!-- <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label id="title" class="font-weight-bold" for="patientid"><i
                                                class="fa fa-search"></i> Enter the Patient ID no. you are going to
                                            enter Medical Records for(Required):</label>
                                        <input type="text" name="patientid" class="form-control"
                                            placeholder="Enter patient ID to retrieve the particulars of that patient *"
                                            required />

                                        <div class="valid-feedback"><i class="fa fa-check-circle"></i> Patient ID number
                                            is valid</div>
                                        <div class="invalid-feedback"><i class="fas fa-exclamation-circle"></i> Please
                                            enter a patient ID number
                                        </div>
                                    </div>
                                </div>
                            </div> --}}

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <label for="patientName" id="title" class="font-weight-bold"><i
                                                class="fa fa-user"></i> Patient Name</label>

                                        <select class="form-control" name="patientName" required>
                                            {{#each users}}
                                            <option value="{{name}}">{{name}}</option>
                                            {{/each}}
                                        </select>
                                    </div>

                                    <div class="col-sm-12 col-md-6 col-lg-6">
                                        <label for="patientid" id="title" class="font-weight-bold"><i
                                                class="fa fa-id-card"></i> Patient ID number:</label>

                                        <select class="form-control" name="patientID" required>
                                            {{#each users}}
                                            <option value="{{patientID}}">{{patientID}}</option>
                                            {{/each}}
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <br>

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                        <div class="form-group">
                                            <label id="title" class="font-weight-bold" for="medicalrecords"><i
                                                    class="fas fa-book-medical"></i> Medicine presribing to
                                                patient(Required):</label>
                                            <textarea class="col-sm-12 col-md-12 col-lg-12 form-control"
                                                id="medicalrecords" name="medicalrecords" rows="8" cols="160"
                                                placeholder="Eg. Cough syrup, Panadol, Sofidroux" required></textarea>
                                        </div>

                                        <div class="form-group">
                                            <label id="title" class="font-weight-bold" for="information"><i
                                                    class="fa fa-info-circle"></i> Other information(Optional):</label>
                                            <textarea class="col-sm-12 col-md-12 col-lg-12 form-control"
                                                id="information" name="information" rows="7" cols="160"
                                                placeholder="Eg. Take cough syrup 5 mls 3 times per day"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {{!-- <br>

                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label id="title" class="font-weight-bold" for="information"><i
                                                class="fa fa-info-circle"></i> Other information(Optional):</label>
                                        <textarea class="col-sm-5 col-md-6 col-lg-12 form-control" id="information"
                                            name="information" rows="7" cols="160" placeholder="Eg."></textarea>
                                    </div>
                                </div>
                            </div> --}}
                        </div>
                    </fieldset>
                    <br>
                    <button type="submit" id="butSaveRecord" class="btn btn-primary"
                        action="/records/listRecords">Save</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    var consultModal = document.getElementById("consultModal");
    var butOpenModal = document.getElementById("consultationBtn");
    var closeModal = document.getElementsByClassName("close")[0];

    butOpenModal.onclick = function () {
        consultModal.style.display = "block";
    }

    closeModal.onclick = function () {
        consultModal.style.display = "none";
    }
</script>